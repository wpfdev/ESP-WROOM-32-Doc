# ESP-WROOM-32 | Настройка Arduino IDE | Linux | Ubuntu | Windows [(EN)](/README_ru.md)

# Интернет вещей

В этой документации вы узнаете, как настроить среду для работы с arduino IDE и использовать микропроцессор ESP-WROOM-32.

## Предварительные требования

- Отладочная плата с микроконтроллером ESP-WROOM-32 8266
- Макетная плата и набор проводников с пинами
- Светодиоды 1-2 шт
- Резисторы (> 3 Ом)
- Батарея 3,3 В (не обязательна, можно подключить по USB)
- USB-Дата кабель (кабель для зарядки может не подойти)
- Базовые знания по подключению к электросети

## Программное обеспечение

- python2.7
- Важные пакеты python: pyserial, esptool
- Arduino IDE: [Ссылка для скачивания](https://www.arduino.cc/en/Main/Software) - В зависимости от настроек вашей операционной системы выберите 32- или 64-разрядную версию

## Процедура установки Arduino

### Для Linux/Ubuntu

- Загрузите Arduino IDE с [здесь](https://www.arduino.cc/en/Main/Software)
- После загрузки файла tar.xz по ссылке, указанной выше, поместите его в директорию
- Снимите ярлык с пакета с помощью `tar -xf arduino-<номер версии>.tar.xz`.
- Запустите `sudo ./arduino-<номер версии>/install.sh`

### Для Windows

- Загрузите [здесь](https://www.arduino.cc/en/Main/Software)
- Что касается установочной части, просто запустите программу установки после загрузки

## Процедура настройки Arduino

Теперь, когда у нас установлена Arduino IDE, нам нужно настроить ее для платы ESP-Wroom-32.

- Откройте arduino IDE
- Для Linux/Ubunutu я бы рекомендовал открыть ее из termial от имени пользователя root, `sudo arduino`
- Для Windows
- Для тех, кто устанавливал программу с помощью installer, просто откройте ее из "Пуск"
- Для тех, кто скачал zip, откройте приложение, нажав на `arduino.exe` в извлеченной папке.

- Перейдите в меню `File` > выберите `Preferences`
- Введите `https://dl.espressif.com/dl/package_esp32_index.json` в поле `Additional Board Manager URLs`
- Нажмите кнопку `ОК`
- Затем перейдите в `Tools` > `Board` > `Boards Manager...`
- Во всплывающем окне найдите **esp32** и затем выберите "**ESP32 от Espressif Systems**"
- Затем нажмите "Установить`

## Первый код

Теперь у нас есть плата и ide настроена. Теперь мы попробуем подключить плату и введем наш первый код.

Теперь подключите плату, используя один USB-кабель.

- Перейдите в `Tools` >  `Board` > Из выпадающего списка выберите **ESP32 Dev Module**

- Снова перейдите в меню  `Tools` и проверьте, настроена ли плата (автоматически).
- Выберите подменю `Port` и убедитесь, что оно не отключено в раскрывающемся списке

- Перейдите в `File` > `Examples` > `01.Basics` > Выберите `Blink`

Откроется новое окно с примером кода, который выглядит следующим образом:


```code
void setup() {
  pinMode(LED_BUILTIN, OUTPUT);
}

void loop() {
  digitalWrite(LED_BUILTIN, HIGH);
  delay(1000);
  digitalWrite(LED_BUILTIN, LOW); 
  delay(1000);
}
```

Немного измените этот код, добавив `int LED_BUILTIN = 2;` прямо перед функцией `setup()`.

- Как только вы закончите, сохраните этот новый скетч (скетч - это рабочая тетрадь, в которой вы пишете код в Arduino IDE).
- Скомпилируйте код используя меню `Sketch` > `Verify/Compile` (или нажмите `Ctrl + R`)
- После успешной компиляции загрузите код в микроконтроллер, используя меню `Sketch` > `Upload` (или нажмите `Ctrl + U`).

Как только ваш код будет успешно загружен, вы сможете увидеть, как синий светодиод ESP-WROOM-32 начнет мигать (на это указывает `int LED_BUILTIN = 2`)


## Возможные проблемы:

### Порт не отображается (Ubuntu/Linux)

Причина: `ls -l /dev/tty<имя порта>` покажет вам, что у другого пользователя нет доступа для записи.

Решение:
- Либо сделайте порт доступным для других пользователей, добавив других пользователей к этому порту
<br> либо
- Убедитесь, что вы запустили ide с помощью пользователя root
- Попробуйте повторно подключить плату
- Попробуйте перезапустить ide

### Ошибка компиляции из-за ошибки импорта модуля serial/esptool:

Причина:
- Возможно, у вас не были установлены пакеты python
- Возможно, вы установили их, используя версию python, отличную от стандартной
- У вас может быть несколько версий python, убедитесь, что в той, которая имеет значение "python -version", установлены пакеты

### Ошибка загрузки кода в микроконтроллер

Причина: Контроллер не переведен в режим записи прошивки

Решение:
- Перед тем как запустить загрузку прошивки в плату микроконтроллера, нажмите кнопку `Boot` и сразу запускайте процесс прошивки через команду меню `Sketch` > `Upload`

Решение:
- `pip install pySerial esptool`
